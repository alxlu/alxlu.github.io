var camera,renderer,scene,geometry,material,container,cube,dome,test,mesh,meshx,mouseY=0,mouseX=0,ready=!1,drops=[],dropContainer,dropIndex=0,particleCount=16E3,particles,pMaterial,particleSystem,zrotoffset=0,yrotoffset=0,xrotoffset=0,loader=new THREE.JSONLoader;init();anim();
function init(){camera=new THREE.PerspectiveCamera(15,window.innerWidth/window.innerHeight,0.01,8E3);camera.position.z=120;camera.position.y=-400;scene=new THREE.Scene;geometry=new THREE.Geometry;renderer=new THREE.WebGLRenderer;renderer.setSize(window.innerWidth,window.innerHeight);renderer.setClearColor(0);container=document.createElement("div");container.setAttribute("id","clouds");document.body.appendChild(container);container.appendChild(renderer.domElement);document.body.style.overflow="hidden";
document.body.style.margin="0";var a=new THREE.MeshLambertMaterial({map:THREE.ImageUtils.loadTexture("zcloudbg.jpg"),wireframe:!1});a.side=THREE.BackSide;dome=new THREE.Mesh(new THREE.SphereGeometry(5E3,30,30),a);dome.rotation.x=0.5;particles=new THREE.Geometry;pMaterial=new THREE.ParticleBasicMaterial({color:16777215,size:5,map:THREE.ImageUtils.loadTexture("raindrop.png"),transparent:!0,opacity:0.7});for(a=0;a<particleCount;a++){var b=new THREE.Vector3;b.z=300*Math.random()-100;b.x=400*Math.random()-
200;b.y=2E3*-Math.random()-600;b.velocity=new THREE.Vector3(0.3*(Math.random()-0.5),8*-Math.random()-7,0.3*(Math.random()-0.5));particles.vertices.push(b)}particleSystem=new THREE.ParticleSystem(particles,pMaterial);scene.add(particleSystem);particleSystem.sortParticles=!0;console.log(particleSystem);a=new THREE.PointLight(3881787);a.position.set(100,250,100);scene.add(a);a=new THREE.PointLight(3881787);a.position.set(50,30,34);scene.add(a);loader.load("test01.js",function(a){THREE.GeometryUtils.center(a);
var b=a.clone();console.log(a.faces);for(var d=1;23>=d;d++)mesh=new THREE.Mesh(b),mesh.position.y=7.225*d,THREE.GeometryUtils.merge(a,mesh);b=a.clone();for(d=1;2>=d;d++)mesh=new THREE.Mesh(b),mesh.position.z=4.45*d,THREE.GeometryUtils.merge(a,mesh);THREE.GeometryUtils.center(a);test=new THREE.Mesh(a,new THREE.MeshLambertMaterial({wireframe:!1}));console.log(test);test.scale.x=test.scale.y=test.scale.z=10;test.rotation.y=1.571;test.position.y=-1E3;test.position.z=50;scene.add(test)});camera.lookAt(new THREE.Vector3(0,
-1E3,0));scene.add(dome);scene.add(camera);cssAnim();dropContainer=document.createElement("ul");dropContainer.setAttribute("id","drops");dropContainer.style.opacity="0.6";document.body.insertBefore(dropContainer,container);setDrops(15);window.setInterval(function(){dropIndex<drops.length&&(drops[dropIndex].style.visibility="visible");dropIndex++},400);window.addEventListener("mousemove",onMouseMove,!1)}
function setDrops(a){for(var b=0;b<=a;b++){var c=document.createElement("div");c.style.visibility="hidden";c.style.background="url(droplets/drop_0000"+Math.floor(7*Math.random())+".png) no-repeat";c.style.width="60px";c.style.height="60px";c.style.display="block";c.style.position="absolute";c.style.top=Math.random()*window.innerHeight+"px";c.style.right=Math.random()*window.innerWidth+"px";drops.push(c);dropContainer.appendChild(c)}}
function clearDrops(){drops.forEach(function(a){dropContainer.removeChild(a)});drops.length=0}function cssAnim(){var a=document.createElement("style");a.type="text/css";a.setAttribute("id","raindrops");var b;b=[];for(var c=0;4>c;c++)b.push("@keyframes dropslide"+c+" { "),b.push("}");b=b.join("\n");a.innerHTML=b;document.getElementsByTagName("head")[0].appendChild(a)}
function anim(){requestAnimationFrame(anim);camera.position.y-=4;pMaterial.size+=9>pMaterial.size?0.03:0;for(var a=particleCount;a--;){var b=particles.vertices[a];-2E3>b.y&&(b.y=0,b.z=300*Math.random()-100,b.x=400*Math.random()-200);b.add(b.velocity)}-1950>=camera.position.y&&(camera.position.y=-400,zrotoffset=yrotoffset=xrotoffset=0,clearDrops(),setDrops(15),dropIndex=0,pMaterial.size=5);particleSystem.geometry.__dirtyVertices=!0;camera.lookAt(particleSystem.position);zrotoffset=0.4<=zrotoffset?
zrotoffset:zrotoffset+0.002;camera.rotation.z=zrotoffset;xrotoffset+=1E-6*(-(mouseY-window.innerHeight/2)-0);yrotoffset+=1E-6*(-(mouseX-window.innerWidth/2)-0);camera.rotation.y+=yrotoffset;camera.rotation.x+=xrotoffset;renderer.render(scene,camera)}function onMouseMove(a){mouseX=a.clientX;mouseY=a.clientY};
